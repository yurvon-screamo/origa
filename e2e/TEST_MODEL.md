# E2E Test Model

## Overview

Документ описывает все тест-кейсы для end-to-end тестирования приложения Origa.

## Test Environment

- **Base URL**: `http://localhost:8080`
- **Browser**: Chromium
- **Test User**: `demo`

---

## Module 1: Authentication (Login)

### Page Objects

- `LoginPage` - `e2e/pages/LoginPage.ts`

### Test Cases

| ID      | Test Case                             | Precondition                  | Steps                                                     | Expected Result                                                  |
| ------- | ------------------------------------- | ----------------------------- | --------------------------------------------------------- | ---------------------------------------------------------------- |
| AUTH-01 | Вход с валидным username "demo"       | Приложение на странице логина | 1. Ввести "demo" в поле username<br>2. Нажать "Войти"     | Редирект на `/home`, отображается HomePage                       |
| AUTH-02 | Ошибка при пустом username            | Приложение на странице логина | 1. Оставить поле username пустым<br>2. Нажать "Войти"     | Отображается ошибка "Введите имя пользователя", URL остается `/` |
| AUTH-03 | Вход с произвольным валидным username | Приложение на странице логина | 1. Ввести "testuser" в поле username<br>2. Нажать "Войти" | Редирект на `/home`, отображается HomePage                       |
| AUTH-04 | Вход с клавишей Enter                 | Приложение на странице логина | 1. Ввести "demo" в поле username<br>2. Нажать Enter       | Редирект на `/home`, отображается HomePage                       |

---

## Module 2: Home Page

### Page Objects

- `HomePage` - `e2e/pages/HomePage.ts`

### Test Cases

| ID      | Test Case                       | Precondition             | Steps                 | Expected Result                                                     |
| ------- | ------------------------------- | ------------------------ | --------------------- | ------------------------------------------------------------------- |
| HOME-01 | Отображение карточек статистики | Пользователь авторизован | 1. Перейти на `/home` | Отображаются карточки: Канжи, Слова, Уровень (N5), секция "Сегодня" |

### Validation Points

- Карточка "Канжи" содержит числовое значение
- Карточка "Слова" содержит числовое значение
- Карточка "Уровень" содержит значение "N5"
- Секция "Сегодня" с карточкой приветствия

---

## Module 3: Profile Page

### Page Objects

- `ProfilePage` - `e2e/pages/ProfilePage.ts`

### Test Cases

| ID      | Test Case                                   | Precondition                                           | Steps                                                         | Expected Result                                                                                                                                        |
| ------- | ------------------------------------------- | ------------------------------------------------------ | ------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| PROF-01 | Отображение всех элементов страницы профиля | Пользователь авторизован                               | 1. Перейти на `/profile`                                      | Отображаются: заголовок, поле username, селектор уровня, селектор языка, поле Duolingo токена, переключатель напоминаний, кнопки "Сохранить" и "Выйти" |
| PROF-02 | Отображение имени пользователя в заголовке  | Пользователь авторизован как "demo"                    | 1. Перейти на `/profile`                                      | Заголовок содержит "demo"                                                                                                                              |
| PROF-03 | Отображение имени пользователя в поле ввода | Пользователь авторизован как "demo"                    | 1. Перейти на `/profile`                                      | Поле username содержит "demo"                                                                                                                          |
| PROF-04 | Изменение Duolingo токена                   | Пользователь на странице профиля                       | 1. Ввести новый токен в поле Duolingo JWT Token               | Поле содержит введенный токен                                                                                                                          |
| PROF-05 | Переключение напоминаний                    | Пользователь на странице профиля, напоминания включены | 1. Нажать на переключатель напоминаний                        | Напоминания отключены (checkbox unchecked)                                                                                                             |
| PROF-06 | Сохранение изменений                        | Пользователь на странице профиля                       | 1. Изменить Duolingo токен<br>2. Нажать "Сохранить изменения" | Кнопка показывает состояние загрузки, затем возвращается в исходное состояние, изменения сохранены                                                     |
| PROF-07 | Выход из аккаунта                           | Пользователь на странице профиля                       | 1. Нажать "Выйти из аккаунта"                                 | Редирект на `/`, отображается страница логина                                                                                                          |

### UI Elements Checklist

#### Header

- [x] Заголовок "Профиль {username}"

#### Personal Data Card

- [x] Поле "Имя пользователя" (readonly)
- [x] Селектор "Целевой уровень JLPT" (N5, N4, N3, N2, N1)
- [x] Селектор "Язык интерфейса"

#### Integrations Card

- [x] Поле "Duolingo JWT Token"

#### Settings Card

- [x] Переключатель "Напоминания"

#### Action Buttons

- [x] Кнопка "Сохранить изменения"
- [x] Кнопка "Выйти из аккаунта"

---

## Module 4: Words Page

### Page Objects

- `WordsPage` - `e2e/pages/WordsPage.ts`

### Test Cases

| ID       | Test Case                                   | Precondition                  | Steps                                              | Expected Result                                                          |
| -------- | ------------------------------------------- | ----------------------------- | -------------------------------------------------- | ------------------------------------------------------------------------ |
| WORDS-01 | Отображение всех элементов страницы слов    | Пользователь авторизован      | 1. Перейти на `/words`                             | Отображаются: заголовок "Слова", поле поиска, кнопка "+", кнопка "Назад" |
| WORDS-02 | Отображение фильтров категорий              | Пользователь на странице слов | 1. Проверить наличие фильтров                      | Отображаются фильтры: Все, Новые, Сложные, В процессе, Изученные         |
| WORDS-03 | Отображение списка карточек слов            | Пользователь на странице слов | 1. Проверить список карточек                       | Отображается минимум одна карточка со словом                             |
| WORDS-04 | Поиск по ключевому слову (японский)         | Пользователь на странице слов | 1. Ввести "Кошка" в поле поиска                    | Отображается карточка со словом "猫"                                     |
| WORDS-05 | Поиск по переводу                           | Пользователь на странице слов | 1. Ввести "Собака" в поле поиска                   | Отображается карточка со словом "犬"                                     |
| WORDS-06 | Пустое состояние при отсутствии результатов | Пользователь на странице слов | 1. Ввести несуществующее слово                     | Отображается сообщение "Слов не найдено"                                 |
| WORDS-07 | Переключение фильтров                       | Пользователь на странице слов | 1. Нажать фильтр "Новые"<br>2. Нажать фильтр "Все" | Фильтры переключаются, активный фильтр подсвечивается                    |
| WORDS-08 | Отображение счетчиков в фильтрах            | Пользователь на странице слов | 1. Проверить счетчик в фильтре "Все"               | Счетчик показывает количество > 0                                        |
| WORDS-09 | Возврат на главную страницу                 | Пользователь на странице слов | 1. Нажать кнопку "Назад"                           | Редирект на `/home`                                                      |

### UI Elements Checklist

#### Header

- [x] Заголовок "Слова"
- [x] Кнопка "Назад"
- [x] Кнопка "+" (добавить слово)

#### Filters

- [x] Фильтр "Все" со счетчиком
- [x] Фильтр "Новые" со счетчиком
- [x] Фильтр "Сложные" со счетчиком
- [x] Фильтр "В процессе" со счетчиком
- [x] Фильтр "Изученные" со счетчиком

#### Content

- [x] Поле поиска
- [x] Карточки слов (слово, перевод, метрики)
- [x] Сообщение о пустом результате

---

## Test Execution Matrix

| Module         | Total Tests | Passed | Failed |
| -------------- | ----------- | ------ | ------ |
| Authentication | 4           | -      | -      |
| Home Page      | 1           | -      | -      |
| Profile Page   | 7           | -      | -      |
| Words Page     | 9           | -      | -      |
| **Total**      | **21**      | -      | -      |

---

## Test Data

### User Credentials

| Username   | Description                          |
| ---------- | ------------------------------------ |
| `demo`     | Стандартный тестовый пользователь    |
| `testuser` | Произвольный пользователь для тестов |

### Sample Data

| Field                      | Value                |
| -------------------------- | -------------------- |
| Duolingo Token             | `test-token-12345`   |
| Duolingo Token (save test) | `new-duolingo-token` |

---

## Running Tests

```bash
# Run all tests
npm test

# Run tests with UI
npm run test:ui

# Run tests in headed mode
npm run test:headed

# Run tests with debug
npm run test:debug
```

---

## Notes

1. Все тесты требуют запущенного dev-сервера на порту 8080
2. Тесты используют `reuseExistingServer: true` для подключения к уже запущенному серверу
3. Скриншоты сохраняются только для упавших тестов
